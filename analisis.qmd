---
title: "analisis"
format: html
---

```{r}
library(sjPlot)
library(ggplot2)
library(ggeffects)
library(tidyverse)
```

```{r}
source("R/data.R")
source("R/lmm_hfmse.R")
source("R/lmm_rulm.R")
```

```{r}
datos_escalas |>
  mutate(scale = factor(scale, levels = c(
    "HFMSE", "RULM", "ALSFRS_R", "EK2", "WALK_TEST", "CHOP"
  ))) |>
  ggplot(aes(age, score, color=smn2num, group=patient_id)) +
  geom_line() + 
  facet_wrap(~ scale, scales="free")
```

```{r}
datos_escalas |>
  mutate(scale = factor(scale, levels = c(
    "HFMSE", "RULM", "ALSFRS_R", "EK2", "WALK_TEST", "CHOP"
  ))) |>
  ggplot(aes(age, score, color=txgroup, group=patient_id)) +
  geom_line() + 
  facet_wrap(~ scale, scales="free")
```


```{r}
tab_model(hfmse.fit, dv.labels = "HFMSE [/66]")
```

```{r}
ggeffect(hfmse.fit, c("age", "txgroup", "sma_type")) |> plot() +
  scale_x_continuous(limits=c(18, 75), breaks=seq(20, 75, 10)) +
  labs(x = "Age", y = "HFMSE [/66]", color = "Treatment")
```

```{r}
tab_model(rulm.fit, dv.labels = "RULM [/37]")
```

```{r}
ggeffect(rulm.fit, c("age", "txgroup", "sma_type")) |> plot() +
  scale_x_continuous(limits=c(18, 75), breaks=seq(20, 75, 10)) +
  labs(x = "Age", y = "RULM [/37]", color = "Treatment")
```
